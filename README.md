# Mail_Service-TG_Notifications

### –°–µ—Ä–≤–∏—Å —Ä–∞—Å—Å—ã–ª–∫–∏ Email –∏ Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π 

---

## üöÄ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ 

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç ‚Äî —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–∏–Ω–∏-—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å, –∑–∞–ø—É—Å–∫–∞—Ç—å –∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –º–∞—Å—Å–æ–≤—ã–µ —Ä–∞—Å—Å—ã–ª–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ Email –∏ —á–µ—Ä–µ–∑ Telegram.  
–í—Å—è –ª–æ–≥–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞ FastAPI, –∑–∞–¥–∞—á–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ Celery —Å –±—Ä–æ–∫–µ—Ä–æ–º Redis. –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–∞–º–ø–∞–Ω–∏–π –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ PostgreSQL.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∫–∞–º–ø–∞–Ω–∏—è–º–∏, –∑–∞–¥–∞—á–∞–º–∏ —Ä–∞—Å—Å—ã–ª–∫–∏
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (FastAPI + SQLAlchemy + asyncpg)
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —á–µ—Ä–µ–∑ email –∏ Telegram (–º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –¥—Ä—É–≥–∏–µ –∫–∞–Ω–∞–ª—ã)
- –û—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ Celery + Redis (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏)
- –£–¥–æ–±–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
- –ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É –≤ Docker-–æ–∫—Ä—É–∂–µ–Ω–∏–∏

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **app/api/** ‚Äî —Ä–æ—É—Ç–µ—Ä—ã FastAPI
- **app/db/** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ —Å–µ—Å—Å–∏—è–º–∏
- **app/models/** ‚Äî SQLAlchemy-–º–æ–¥–µ–ª–∏
- **app/schemas/** ‚Äî Pydantic-—Å—Ö–µ–º—ã (–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)
- **app/tasks/** ‚Äî –∑–∞–¥–∞—á–∏ Celery
- **app/utils/** ‚Äî —É—Ç–∏–ª–∏—Ç—ã, —ç–º—É–ª—è—Ç–æ—Ä—ã –æ—Ç–ø—Ä–∞–≤–∫–∏
- **celery_app.py** ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Celery
- **config.py** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
- **main.py** ‚Äî –≥–ª–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
- **.env** ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **requirements.txt** ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
- **docker-compose.yml** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è Docker Compose
- **Dockerfile** ‚Äî —Å–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞
- **README.md** ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è


## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (Windows, –±–µ–∑ Docker)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏ Python 3.11+  
[–°–∫–∞—á–∞—Ç—å Python –¥–ª—è Windows](https://www.python.org/downloads/windows/)

### 2. 
git clone https://github.com/Jeff555max/Mail_Service-TG_Notifications.git

cd Mail_Service-TG_Notifications

3. –°–æ–∑–¥–∞–π –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

python -m venv .venv

.venv\Scripts\activate

4. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

pip install --upgrade pip

pip install -r requirements.txt

5. –ù–∞—Å—Ç—Ä–æ–π —Ñ–∞–π–ª .env

–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:


DATABASE_URL=postgresql+asyncpg://postgres:postgres@localhost:5432/postgres

REDIS_BROKER_URL=redis://localhost:6379/0

–£–±–µ–¥–∏—Å—å, —á—Ç–æ PostgreSQL –∏ Redis –∑–∞–ø—É—â–µ–Ω—ã –Ω–∞ —Ç–≤–æ–µ–π –º–∞—à–∏–Ω–µ!

6. –ó–∞–ø—É—Å—Ç–∏ Redis
(—Å–∫–∞—á–∞–π redis –¥–ª—è Windows, —Ä–∞—Å–ø–∞–∫—É–π –∏ –∑–∞–ø—É—Å—Ç–∏ redis-server.exe)

7. –ó–∞–ø—É—Å—Ç–∏ FastAPI

uvicorn app.main:app --reload

Swagger UI –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://127.0.0.1:8000/docs

8. –ó–∞–ø—É—Å—Ç–∏ Celery worker

celery -A app.celery_app.celery worker --loglevel=info --pool=solo



## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose (Linux/macOS/WSL/Windows —Å Docker Desktop)

docker compose up --build

–≠—Ç–æ –ø–æ–¥–Ω–∏–º–µ—Ç —Å–µ—Ä–≤–∏—Å FastAPI, Celery worker, Redis –∏ PostgreSQL –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

–í —Ñ–∞–π–ª–µ docker-compose.yml –≤–≤–µ–¥–∏—Ç–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ Redis.

–ù–∞—Å—Ç—Ä–æ–π —Ñ–∞–π–ª .env

–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–ª—è  –∑–∞–ø—É—Å–∫–∞:

REDIS_BROKER_URL=redis://redis:6379/0

DATABASE_URL=postgresql+asyncpg://postgres:postgres@db:5432/postgres


Swagger UI: http://localhost:8000/docs


üìë –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏ —á–µ—Ä–µ–∑ API

POST /api/campaigns/

1.

{

  "title": "–ò–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤",

  "text": "–°–∫–∏–¥–∫–∏ –Ω–∞ –≤—Å–µ —Ü–≤–µ—Ç—ã —Ç–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è!",

  "users": [

    {"email": "user1@mail.com", "telegram_id": "12345"},

    {"email": "user2@mail.com"}

  ]

}
2.

–ü—Ä–∏–º–µ—Ä —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞ (JSON)

–ù—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç —Ä–∞—Å—Å—ã–ª–∫–∏ –∏ —Å–ø–∏—Å–æ–∫ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (user_ids), –∫–æ—Ç–æ—Ä—ã–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. 
–ü—Ä–∏–º–µ—Ä:


{
  "text": "–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞.",
  "user_ids": [1, 2, 3]
}

–û—Ç–≤–µ—Ç:

 curl -X 'POST' \
  'http://localhost:8000/campaigns/' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
  "text": "–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! –≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞.",
  "user_ids": [1, 2, 3]
}
'







